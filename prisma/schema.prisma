// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model tbm_user {
  uid String @unique
}

// ====================================================
// DATA SETUP
// ====================================================

model tbm_cdio_syllabus_parent {
  id            String              @id @default(uuid())
  level         Decimal?            @db.Decimal(2, 1)
  title         String?             @default("")
  created_at    DateTime?           @default(now())
  updated_at    DateTime?           @updatedAt
  cdio_syllabus tbm_cdio_syllabus[]
}

model tbm_cdio_syllabus {
  id                      String                    @id @default(uuid())
  level                   Decimal?                  @db.Decimal(2, 1)
  title                   String?                   @default("")
  created_at              DateTime?                 @default(now())
  updated_at              DateTime?                 @updatedAt
  id_cdio_syllabus_parent String?
  cdio_syllabus_parent    tbm_cdio_syllabus_parent? @relation(fields: [id_cdio_syllabus_parent], references: [id])
  rubrik                  tbm_rubrik[]
}

model tbm_student_outcome {
  id         String       @id @default(uuid())
  code       String       @unique
  title      String?      @default("")
  created_at DateTime?    @default(now())
  updated_at DateTime?    @updatedAt
  rubrik     tbm_rubrik[]
}

model tbm_student_outcome_level {
  id          String    @id @default(uuid())
  level       Decimal?  @unique @db.Decimal(2, 1)
  title       String?   @default("")
  description String?   @default("")
  created_at  DateTime? @default(now())
  updated_at  DateTime? @updatedAt
}

model tbm_assessment_method {
  id                      String                        @id @default(uuid())
  title                   String?                       @default("")
  created_at              DateTime?                     @default(now())
  updated_at              DateTime?                     @updatedAt
  course_learning_outcome tbl_course_learning_outcome[]
}

model tbm_jurusan {
  id            String              @id @default(uuid())
  title         String?             @default("")
  created_at    DateTime?           @default(now())
  updated_at    DateTime?           @updatedAt
  program_studi tbm_program_studi[]
}

model tbm_program_studi {
  id         String       @id @default(uuid())
  title      String?      @default("")
  created_at DateTime?    @default(now())
  updated_at DateTime?    @updatedAt
  id_jurusan String
  jurusan    tbm_jurusan  @relation(fields: [id_jurusan], references: [id])
  rubrik     tbm_rubrik[]
  course     tbl_course[]
}

model tbm_rubrik {
  id                 String              @id @default(uuid())
  id_program_studi   String
  id_student_outcome String
  id_cdio_syllabus   String
  code               String?
  title              String?
  desc_level_1       String?             @default("-")
  desc_level_2       String?             @default("-")
  desc_level_3       String?             @default("-")
  desc_level_4       String?             @default("-")
  desc_level_5       String?             @default("-")
  program_studi      tbm_program_studi   @relation(fields: [id_program_studi], references: [id])
  student_outcome    tbm_student_outcome @relation(fields: [id_student_outcome], references: [id])
  cdio_syllabus      tbm_cdio_syllabus   @relation(fields: [id_cdio_syllabus], references: [id])
  created_at         DateTime?           @default(now())
  updated_at         DateTime?           @updatedAt
}

// ====================================================
// DATA MAIN
// ====================================================

model tbl_course {
  id               String  @id @default(uuid())
  id_program_studi String
  code             String? @unique
  title            String? @default("")
  sks              Int?    @default(0)

  bobot_assignment          Int? @default(0)
  bobot_quiz                Int? @default(0)
  bobot_mid_exam            Int? @default(0)
  bobot_final_exam          Int? @default(0)
  bobot_practice_or_project Int? @default(0)
  bobot_presentation        Int? @default(0)

  sum_of_level Int? @default(0)
  target_level Int? @default(0)

  program_studi           tbm_program_studi             @relation(fields: [id_program_studi], references: [id])
  created_at              DateTime?                     @default(now())
  updated_at              DateTime?                     @updatedAt
  course_learning_outcome tbl_course_learning_outcome[]
}

model tbl_course_learning_outcome {
  id                   String                @id @default(uuid())
  title                String?               @default("")
  id_course            String
  id_assessment_method String
  course               tbl_course            @relation(fields: [id_course], references: [id])
  assessment_method    tbm_assessment_method @relation(fields: [id_assessment_method], references: [id])
  created_at           DateTime?             @default(now())
  updated_at           DateTime?             @updatedAt
}
